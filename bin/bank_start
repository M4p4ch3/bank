#!/usr/bin/env python

from curses import wrapper
import logging
import sys

from bank.internal import Account
from bank.display.my_curses import (DisplayerMain, DisplayerAccount)
from bank.utils import RetCode

def wrap(win):
    """
    Curses wrapper
    """

    # Init display
    disp = DisplayerMain(win)

    # Init account display
    account_disp = DisplayerAccount(account, disp)

    # Browse account
    account_disp.browse_container()

logging.basicConfig(
    level=logging.DEBUG,
    format="[%(levelname)s] (%(name)s:%(lineno)d) %(message)s"
)

logger = logging.getLogger("bank_start")

# Init account
account = Account("current", "./data/")

# Import account file
ret = account.import_file()
if ret != RetCode.OK:
    logger.error("Import account file of %s FAILED", "current")
    sys.exit(RetCode.ERROR)

# Curses wrapper
wrapper(wrap)
