#!/usr/bin/env python

from curses import wrapper
import logging
import sys

from bank.internal import Account
from bank.display.my_curses import (DisplayerMain, DisplayerAccount)
from bank.utils import RetCode

def wrap(win):
    """
    Curses wrapper
    """

    # Init display
    disp = DisplayerMain(win)

    # Init account display
    account_disp = DisplayerAccount(account, disp)

    # Browse account
    account_disp.browse_container()

LOG_FMT = "[%(levelname)s][%(name)s] %(filename)s:%(funcName)s:%(lineno)d %(message)s"
logging.basicConfig(format=LOG_FMT)

logger = logging.getLogger("bank_start")

# Init account
account = Account("data", 1, "current")

# Import account file
ret = account.import_file()
if ret != RetCode.OK:
    logger.error("account.import_file FAILED")
    sys.exit(RetCode.ERROR)

# Curses wrapper
wrapper(wrap)
